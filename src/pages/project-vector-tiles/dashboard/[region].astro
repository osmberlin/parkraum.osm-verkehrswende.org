---
import { PageDashboardDate } from '@components/PageDashbard/PageDashboardDate'
import { PageDashboardTable } from '@components/PageDashbard/PageDashboardTable'
import { fetchRegionWithContent } from '@components/regions/utils/fetchRegions'
import LayoutArticlePage from '@layouts/LayoutArticlePage.astro'

export async function getStaticPaths() {
  const githubFilesWithContent = await fetchRegionWithContent()
  const regions = await githubFilesWithContent.map((region) => {
    return { params: { region: region.slug }, props: { data: region } }
  })

  return regions
}

// const { region } = Astro.params
const { data } = Astro.props
---

<LayoutArticlePage
  title='Dashboard aus dem Projekt "Vector Tiles"'
  noindex={true}
  menuHighlight="project_vector_tiles_dashboard"
  maxWidthClass="max-w-7xl lg:pr-10"
>
  <h1>Parkraum {data.name}: Statistiken</h1>
  <p class="mt-2 text-sm text-gray-700">
    Die Liste zeigt pro Bezirk bzw. Ortsteil, wie hoch der Anteil der StraÃŸen ist, fÃ¼r die in OSM
    bereits Parkstreifendaten erfasst sind.
  </p>
  <!-- {JSON.stringify(data)} -->
  <p class="notice prose my-6 bg-orange-100">
    ğŸ‘‰ <b>Aktueller Hinweis:</b> Das Parkraumschema in OpenStreetMap wird derzeit erneuert. Unsere Karte
    zeigt nur die neuste Version des OSM-Parkraum-Schemas an. Wenn du in OpenStreetMap dabei helfen mÃ¶chtest,
    die Daten zu aktualisieren, kannst du <a
      href="https://www.openstreetmap.org/user/Supaplex030/diary/401053">hier nachlesen</a
    >, wie das mÃ¶glich ist.
  </p>

  <PageDashboardDate client:idle />
  <div class="mt-8 flex flex-col">
    <div class="overflow-hidden shadow ring-1 ring-black/5 md:rounded-lg">
      <PageDashboardTable client:load regionKey={data.slug} />
    </div>
  </div>
</LayoutArticlePage>
